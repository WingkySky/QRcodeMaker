<view class="container">
  <view class="title">历史记录</view>
  
  <!-- 空状态 -->
  <view class="empty-state" wx:if="{{!history.length}}">
    <image src="/assets/icons/empty.png" mode="aspectFit"></image>
    <text>暂无历史记录</text>
  </view>

  <!-- 历史记录列表 -->
  <view class="history-list" wx:else>
    <view class="card history-item" wx:for="{{history}}" wx:key="createTime">
      <!-- 二维码图片 -->
      <image class="qrcode" src="{{item.qrcodePath}}" mode="aspectFit" bindtap="previewQRCode" data-path="{{item.qrcodePath}}"></image>
      
      <!-- 内容信息 -->
      <view class="info">
        <view class="type">
          <image src="/assets/icons/{{item.type}}.png" mode="aspectFit"></image>
          <text>{{item.type === 'text' ? '文字' : item.type === 'url' ? '网址' : '图片'}}</text>
        </view>
        <text class="content">{{item.content}}</text>
        <text class="time">{{item.createTimeStr}}</text>
      </view>

      <!-- 操作按钮 -->
      <view class="actions">
        <button class="btn-small" bindtap="regenerateQRCode" data-index="{{index}}">重新生成</button>
        <button class="btn-small btn-danger" bindtap="deleteHistory" data-index="{{index}}">删除</button>
      </view>
    </view>
  </view>

  <!-- 清空按钮 -->
  <view class="clear-all" wx:if="{{history.length}}">
    <button class="btn-danger" bindtap="clearHistory">清空历史记录</button>
  </view>
</view> 